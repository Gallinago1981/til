# developer summit 2018 summer

## AIを支えるGPUコンピューティングのいま

- なぜGPU使うと機械学習が早いのか
- GPUはよく使われるのはVR
- HOLODECK
  - オンラインでVR空間に入り込める
  - どんだけ滑らかな３Dオブジェクトでも基本的にはポリゴンで形成されている
  - ポリゴンがどんどん小さくなってはいるが隣同士のピクセル計算であることは今でも変わりない
- GPU 12年の歩み
  - GPU APIだけでしか使えなかった
    - 無理やり置き換えてた
  - GPUの汎用的な計算に使おうという流れができる
    - nvidia CUDA
  - IBM summit 
    - Power 9 というIBMのCPU
    - テスラv100
      - 90%はGPUで叩き出した性能
- 性能測定
  - AMBER
  - Linpackベンチマーク
  -  GPU 4台 = CPU 11
  - CNNによる画像分類(推論)のパフォーマンス

- なぜGPUが早いのか
  - GPUはトランジスタ数が特別多いわけではない
  - 演算器の数に差がある
  - CPUは汎用的に使える必要があるが、GPUはCPUと同じことができても意味がない
    - 並列に同じ計算を多量に行うことに注力している
    - 2000万画素の場合、2000万ピクセルに対し同じ計算を行う。
  - CPUはシングルスレッドの性能強化に注力、GPUは並列で同じことを行う性能強化に注力
  - GPUには分岐予測などは付属していない
  - GPUに得意なことだけをGPUにやらせる

- VOLTA世代
  - TENSOR CORE
    - TENSOR COREに対応したソフトウェアであれば早くなる
    - Chainer 3.0.0rc, CuPy 2.0,0rc

- Tesla V100搭載マシン
  - NVIDIA DGX Station
    - 水冷マシン
    - 静かだよ
  - NVIDIA DGX-2
    - 5年間で500倍の速さになっている

- コンテナ環境でのGPU利用
  - コンテナ毎のソフトウェアバージョンが異なる
  - NVIDIA-docker
    - ホストとコンテナのNVIDAのバージョンがあってないと辛い
    - コンテナの実行時にホストのカーネル？から必要な情報を持ってきてセットアップする
    - v1,0
      - nvidea-docker は dockerのラッパー
    - v2.0
      - dockerのラッパーではなくrunCと並ぶ１つのランタイムとして実装
        - 汎用的になっている
      - ラッパーではなくなった
      - こっちの方がおすすめ
      - nvidea-docker.shとして残ってるよ
  - k8s
    - GPU対応が進んでいるかカオスな状況
    - 使えるようnvideaが本腰を入れている
    - k8sのdevice-plugin,ymlがnvidia用のがある

- NVIDIA GPU CROUD
  - Oracle cloudにも対応している
  - 環境構築の手間が大幅に削減される
    - deep learningに必要な設定は全て終わっているはず
  - NGC の日本語ドキュメントが出てるよ
    - アカウントは無料で作れる
    - nvidia.com/cloud

- NBIDIA DEEP LEARNING INSTITUE
  - ハンズオントレーニング
    - クライアントマシンにGPUがなくてもいい
- 9/13 - 14 GPU TECHNOLOGY CONFERENCE

## AI時代におけるエンジニアの生存戦略

- BIGDATA, Cloudのデータ活用のため統計学が活かされてくる
- AI事業が伸びてきはてはいる
- 採用チャンスはここ2年程度

### データサイエンティストの話

- @kos59125
- Deep Insider -> 機械学習専門のメディア

- 人工知能とは
  - 人間の知的能力をコンピュータ上で実現する様々な技術
  - 販売実績の予測（経験者の感覚）
  - 集合知に基づく予測（マーケティング分析の元出していた結果をSNS上の情報で検知）
  - 異常予測(センサーからの情報をもとに判断)

- AI活用のメリット
  - 量と速度
    - 大量のデータを取り扱える
    - 人よりも圧倒的に早く反応できる

- 事例
  - IDOM(ガリバー)
    - 査定する人が、汚れは傷の程度をデータ化し販売価格をデータ化していた
  - 日活
    - 興行収入の予測を俳優や内容のデータを蓄積して判断していた
    - 口コミサイトの評価なども含め興行収入の予測エミュレーターを作成
  - マネックス証券
    - 公開前コンテンツ文書校正
      - 法律に基づいた記法ができているかなどを
      - 過去の記法に基づいた文章構成
      - 表現記法のチェックを行う
      - 数人係だったのが一部を機械学習に置き換えた

- データサイエンティストの仕事とは
  - 多岐にわたり、1人でカバーは難しい
    - ビジネス、データサイエンス、データエンジニアリングを組織でカバーする
    - 相互理解が必要
    - 無理解の壁があると辛い
  - データエンジニアリング
    - データサイエンスを意味のある形に使えるようにし、実装・運用できるようにする力
    - プラスアルファは必要
      - ビジネス上の課題を実装するとかは必要
      - 課題背景の理解する
      - データサイエンス
        - 情報処理、人工知能、統計学などの情報科学系の知恵を理解し使う力
  - 自分のパートナーのスキルと補完しあうスキルが価値が高い

- まとめ
  - AIエンジニアはデータエンジニアリングスキルをベースにビジネスやデータサイエンスの課題を解決できる
  - ビジネス、データサイエンス領域との相互理解が必要
  - チームにおいて、パートナーと補完しあうスキルを身につける

- トークセッション
  - 実際に今から何をすればなれる
    - ベースとなるスキルが自分にとって何かを知るべき
    - データサイエンス協会
    - 成長する方向性を決める
  - どんな人が欲しい
    - エンジニアリングが特化しすぎると辛い
    - 無理解の壁ができると仕事ができなくなる
    - 排他的になるのは望ましくない
  - データサイエンス人材のバブル？
    - 需要は高まっていくのか？
      - パッケージ化されて需要は減っていくのか
      - 製造業の腰が重かったが、事例が増えてきている
      - バブルは落ち着く
      - 事例を作ることが必要
      - データ活用に失敗して及び腰になっているケースもある
  - エンジニアの仕事はAIに奪われる？
    - 新しいことを生み出すのはまだまだむづかしい
    - SEの過去の知見をAIにとられる可能性はある
    - 新しいビジネス提案についてのエンジニアリングは置き換えられない

## データウェアハウスの設計手法(ディメンショナルモデルの進め)

- ディメンショナルモデル
  - サービス側のデータをredshiftにそのまま登録していた
  - ログもそのまま登録していた
  - 分析チームのみがアクセスできていたので作業待ちが発生していた
  - 誰でも分析基盤にアクセスさせるようにZepelinを介してredshiftにアクセスさせてた

- 集計に関する問題
  - サーバサイドの仕様書を読ませるのは辛い
  - ソースコード読め
  - 複雑なテーブル構造
  - 集計するためのSQLが煩雑、長すぎる
  - 謎のサマリーテーブルが乱立する事態
  - BIツールは助けてくれない
    - データの整備について提案してくれない、加工してくれない

- ディメンショナルモデリングが上記の問題を解決してくれる
  - データ分析の流れ
    - 要件定義（目的、分析手法、ゴール）
    - データ収集（サーバーログ、DB）-> Data Lake
    - ETL (整形ロード) -> Data Warehouse
    - 分析

  - Data Warehouse
    - すぐに分析に取りかかれる
    - 業務データとは違う
  
  - 20年前以上に低層されたDWH
  - FACT
    - イベント状態
  - Dimensions
    - Factに対する説明
    - DimensionとDimensionは繋がらない
  - 進めかた
    - ビジネスプロセスを選ぶ
      - 例）お客さんに提供しているサービス・機能
      - ビジネスプロセスの内容の言語化
      - 使えるデータの確認
    - 粒度を決める
      - Factテーブルの1行で何を表すか
        - どこまで詳細なレベルで分析するか
      - 
    - Dimensionテーブルを決める
      - 5W1Hで定義する
    - Facts
      - イベントに対する計測値
- 良いてん
  - クエリのパフォーマンスが向上
  - 分析軸を柔軟に追加できる
  - ディメンションテーブルが増えれば

- やってみた
  - データを理解するのは難しい
  - 汎用性のないさマリテーブルち
- 作戦
  - できることからちょっとづつ、KPIに影響するものから順に
- 大事だったこと
  - ビジネスプロセスの分析や粒度をきちんと決めたこと
  - Data Warehouse 全体の生合成を保つことができた

- Enterprise Bus Matric

- シンプルなテーブル構造
- 汎用的なサマリテーブル
- セルフサービスなデータ分析

- 辛かったこと
  - 設計するのが大変
    - 時間がかかりすぎるリスク
  - 設計コストと得られるメリットの比較
  - HiveやRedshiftなどでは難しい部分も
    - データ更新
    - 実行効率
      -> 妥協も大事

  - おいしいところだけいただくの精神

## 機械学習の力技

- スピーカーは数学エバンジェリスト
- ITmedia
  - Pythonで機械学習を行うツールが掲載されている
- 機械学習のエッセンス
  - 9月に発売される予定
- scikit-learnは甘え
  - Pythonの標準的なライブラリ
  - 自分で書けw

- PRML（Pattern recognition and machine learning）
  - 数学ができればできるじゃないよ

- すでに実装があっても理解のために自分でかく(積極的車輪の再発明)
- 何を勉強するべきか
  - 数学
    - 線形代数、微積分が大切って言われる
    - どこまで？
      - 線形代数のみに
        - 前処理をちゃんとやりたい
          - ベクトルと行列の演算の定義をしっかり覚えよう
        - 初心者
          - 行列のサイズを意識しよう
          - 積ができるかどうか確認しよう
          - 積がそのくらいのサイズになるか意識しよう
          - サイズがアルゴリズに影響も
            - X 10000かける10のとき
              XtX  XXt
              右は機械学習では避けるべき。でかいのはよくない
              アルゴリズムで計算量を制限する
        - 上級者
          - 「数覚」の一部としての「線形感覚」
            - 線形代数がわかる人ならではの特殊な感覚があるのではないか？
            - 感覚がない人から見ると大きな差を感じる
        - 線形感覚を身につけるには
          - コンピュータではなく手を動かして見る
            - 行列の積、逆行列、行列式、固有値
        - 証明を読むことは無駄ではない
          - 線形代数では証明は「一生懸命計算すること」の抽象化が多い
          - 証明を読むと勉強になることが多い
          - 3 * 3行列の固有値を「手で」求めるあたりを目標にすればいい
  - 数値計算
    - 数学の知識≠数値計算
  - 数理統計学
  - データサイエンティストに数学は必要か？
    - 強みの可能性になるもの１つにすぎない
      - 他に特定業務知識とか、マネージメント力とか、磨けばカネになるものはたくさんある
    - 騒ぎすぎじゃない？

## Alibaba Cloudで実現するクラウド時代のデータ分析基盤の設計とその道のり

- アリババという会社とAlibabaCloudについて
- Alibaba Cloudの技術基盤
  - 2016/12 東京リージョンが開設された
  - いいところ
    - 苦労して乗り越えた技術、ノウハウ
    - フォロワーなのもあってユーザ要望は相当反映される
    - ビックデータ・機械学習プロダクトは自信作
  - 悪いところ
    - サーバレスなど新しい概念はまだ
    - 日本リージョンにはまだない機能がある
- Alibaba Cloudの使ったデータ気分析基盤
  - Fuxi
    - リソースジョブスケジューラ
    - リソースを必要な時に必要なだけ要求するすyる
    - ユーザジョブが実行するときようにモニタリング
  - Pangu
    - 分散ファイルシステム
    - Alibabaが独自に開発している分散ファイルシステム
    - aAlibaba　Cloudの多くのプロダクトのストレージレイヤーとして利用

- Container Service　 
  - Docker * K8sやるよ
  - Docker swarmモード？

- IoT Platoform
  - 価格
    - メッセージの使用件数に応じて課金
    - 100まんメッセージまで無料
    - 92円
    - 1message 512byte　超えた場合は2messageになるので注意

## Cassandra*k8sによる大規模データ基盤の仕組みと苦労

- 抜本的アーキテクチャの見直し
  - RDBMS -> Cassandra
  - オンプレ -> K8s (GCP)

- システムのターゲット
  - 自動車アフターマーケット
    - オーナー様に車が渡った後の業務モデル
    - アフターサービスの市場
    - 車検とか
    - 市場規模は10兆円
  - 扱っているデータ
    - 車の仕様     - 48万
    - 車の部品使用  - 2億/年
    - 流通
    - 
    - 1682万台 日本の約1/4

- さらなる成長、さらなる機会
  - データを基軸としたサービス展開を強化
  - 海外まで

- RDMS数十以上でのインスタンスでの運用
- オンプレでは保守難しい
- サーバーのライセンス費用
- オンプレの集中管理は難しい
- Cloud Spanner
  - コストがやばそうw
- コストを書ければどこでもいい
- ギートリーぶという謎DB

- RDBに慣れているとCassandraは使いにくい
  - Cassandra * Elasticsearch
  - 更新系は全てCassandra, すぐにみたい場合はCassandraのデータ
  - 過去の履歴検索は全てElasticsearchで使う
  - Kafkaを使って非同期更新を行なっている
    - Cassandraの更新情報をKafkaにtriggerでキックしている？
    - CQRSに近い概念
  - 一般的にはKafkaにアクセスして各データストアを更新したほうがいい
  - 集計しようと思うとCassandraきつい
    - 負荷の高い処理は別のデータセンターで実行する
    - データはレプリケーションする
  - DBがスケールアウトしてもアプリケーションが追いつかない
    - ボトルネックが発生
    - k8sでスケールを容易にする

- データの基盤を変えていこう
  - データ基盤だけではなくアーキテクチャ、コミュニケーションまで変えていく必要があった
  - データ + αが必要


## 意外と知らない。GitHubの新機能を紹介します

- @pnsk
- GitHubオンプレ版
- GitHubおさらい
  - バージョン管理
  - Pull Requestによるレビュー
  - Issue機能を使ったタスク管理
  - Project機能でカンバン形式でプロジェクト管理
  - GitHub Pagesを利用したWebページ作成
  - API (REST API GraphQL API)

- GitHub Bussiness Cloud, Enterprice
  - エンドユーザから見ると違いはない
  - 管理面でビジネス面の違いがある
  - Business Cloud
    - SAMLによるSSO
      - Organizationメンバー管理の位置つけ
      - Gitアカウント管理ではない
  - Enterprise
    - オンプレ
    - 認証サービスが色々とあるよ
    - 管理機能
      - 監査ログ、システム監視
      - バックアップ・高可溶性
    - 日本語のテクニカルサポート（営業時間が限定されている）

- GitHibの新機能について

  - Security Alerts
    - 依存ライブラリの脆弱性をチェックすることができる
    - Ruby, JavaScript, Python(new)
      - CVEの脆弱性（）

  - リポジトリのアーカイブ化(readーonlyに変更)
    - Issue、Pull Requestが停止
    - Forkは可能
    - 注意
      - Readmeを明記したほうがいいい
      - IssueやPull RequestはClosesしてね

  - Legal Hold
    - ウェブUIからリポジトリが削除されても、データは削除されない

  - git-sizerコマンド
    - 3月にオープンソースで公開
    - GitHubのサイズメトリクスを計算
    - リポジトリの最大は1GBを推奨している
    - オプションを変更するとディレクトリ名を出すことができリウ

  - git lfs migrate import
    - 過去の履歴を変更せすに指定のファイルをPoint
    - Git LFSでトラッキング
    - https://github.com/git-lfs/git-lfs
    - 過去の更新日を変更せすなかったことにできる

  - git lfs migrate info
    - 拡張子ごtにサイズを解析

  - pull request
    - Finding changed method and function
      - 変更があったコードのメソッドを簡単に発見
      - Ruby, JavaScript, Go, Python, PHP
    - Miulti Review  at Protected branch
      - 特定のブランチの保護機能
        - マージ条件を設定
          - レビュワーの承認必須
          - GPGにより署名必須
          - 必須レビューの数を複数設定可能になった

    - Checks API
      - ビルドの結果の詳細がGitHubからみれる
        - Google Clound Build, Travix CI, App Center, (CircleCI)
  - Issue
    - 重複IssueやPullRequestの管理
      - duplicationをマークをだす
      - コメントにDuplication of #{番号}で重複マークがつけられる
    - multiple Issue templateの改善
      - 障害とか内容に応じたテンプレートを容易できる
      - Bug Repoert, Feature Request
    - Issueの内容、Issueコメントの編集履歴参照
      - 履歴の削除も可能
    - Conversation Locking
      - Issue上での会話を止めることができる
      - 特定ユーザーのみコメント可能にする。

  - 特定のユーザをブロックする
    - ブロック期間の指定ができるようになった

  - Project
    - Projectのテンプレート
      - Basic Kanban
        - "To do", "In progress", "Done"
      - Automated kanban
        - IssueやPullRequestのアクションに応じてカラムを自動変更
      - 追加されたテンプレート
        - Automated kanban with reviews
        - Bugs triage
    - Navigationの追加
      - ProjectからIssue情報を変更
      - リアクション
      - AssigneeやLagelの変更
    - Archive Cards
      - Projectカードをアーカイブ可

    - GitHub pages
      - HTTPS & Custom domaain on GitHub Pages

    - GitHub for Unity 1.0
      - Unityエディタの拡張機能
        - Git捜査、GitHubの機能

    - GitHub Enterpriseの管理機能
- GitHubの最新情報
  - GitHub Blog 
  - Github Blog in Japanese
    - https://blog.github.com/jp/
  - changelogがある
  - https://blog.github.com/changelog/
  - Github enterpriseのrelasenoteがある
  - Community Forum
    - ユーザ同士で利用方法の確認を行うことができる